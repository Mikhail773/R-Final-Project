---
title: "Analysis of Used Car Prices in Belarus"
author: "Brandon Strong, Emma Doyle, Matthew Lane, Mikhail Mikhaylov, Reid Hoffmeier"
date: "4/14/2021"
output: html_document
---
```{r setup, include = FALSE}
library(tidyverse)
library(e1071)
library(car)
knitr::opts_chunk$set(echo = TRUE)
```

## Preparing the data

We first read our dataset into the cars variable
```{r Read-CSV}
cars <- read_csv("cars.csv")
```

Lets prepare the dataset for evaluation

Removing unnecessary columns from cars. Store that data in cars_edited -(19) is a column that shows the number of times a car has been upped. This column not descriptive and has been removed -(20:29) are boolean columns for various features. There is no description of what these features are and for that reason they have been omitted.

```{r Remove-Unneeded-attributes}
cars_edited <- select(cars, -8 & -(12:13) & -(20:29))
View(cars_edited) #view the data
```
```{r Check-NA}
#Check if there are na's in the cars_edited
colSums(is.na(cars_edited))
```

```{r Check-Duplicates}
# Check for Duplicates and remove them
cars_edited <- cars_edited %>% distinct()
```

Recode foreign language into their English meaning (location_region)
Recode foreign language into their English meaning (manufacturer_name)
Recode foreign language into their English meaning (model_name)
Recode foreign language into their English meaning (engine_fuel)

```{r Recode-Attributes}
cars_edited <-
  cars_edited %>%  dplyr::mutate(
    location_region =  dplyr::recode(
      cars_edited$location_region,
      'Брестская обл.' = "Brest Region",
      'Витебская обл.' = "Vitebsk Region",
      'Гомельская обл.' = "Gomel Region",
      'Гродненская обл.' = "Grodno Region",
      'Минская обл.'  = "Minsk Region",
      'Могилевская обл.' = "Mogilev Region"
    )
  )

cars_edited <-
  cars_edited %>%  dplyr::mutate(
    manufacturer_name =  dplyr::recode(
      cars_edited$manufacturer_name,
      'ВАЗ' = "AvtoVAZ",
      'ГАЗ' = "GAZ",
      'ЗАЗ' = "ZAZ",
      'Москвич' = "Moskvitch",
      'УАЗ'  = "UAZ"
    )
  )

cars_edited <-
  cars_edited %>%  dplyr::mutate(
    model_name =  dplyr::recode(
      cars_edited$model_name,
      'Таврия' = "Tavria",
      '968м' = "968M",
      'Соболь' = "Sobol",
      'Луидор' = "Luidor",
      'ВИС'  = "VIS"
    )
  )

cars_edited <-
  cars_edited %>%  dplyr::mutate(engine_fuel =  dplyr::recode(cars_edited$engine_fuel, 'gas' = "compressed natural gas", ))

```

```{r}
View(cars_edited)
```


```{r summary}
summary(cars)
```

## Questions

(Emma Doyle) 1) Box Plots, Bar Graph, ANOVA?: What impact does a region have on price?

(Emma Doyle) 2) Pie Graph/Box Plot, One-Way Anova?: What is the distribution of manufacturers and whether manufacturers have a significant impact on the asking price of a vehicle?

(Reid Hoffmeier) 3) Scatter Plot/Box-Plot, Simple Regression Analysis: What is the relationship between odometer and price?

(Reid Hoffmeier) 4) Scatter Plot, Simple Regression Analysis: Does the number of photos a vehicle has impact the selling price?

(Matthew Lane) 5) Scatter Plot, Simple Regression Analysis: Does the number of times a vehicle has been upped in the catalog to raise its position impact the selling price?

(Matthew Lane) 6) Mosaic Plot/ Chi-Squared Test, Two-Way ANOVA: Relationship between Engine Type and Body Type? What is the impact of Engine Type and Body Type on the selling price?

(Mikhail Mikhaylov) 7) Dplyr count with group_by, One-Way Anova: What is the most popular model and whether we can conclude that the popularity of a model has a direct impact on the price of a vehicle?

Finding out model popularity

```{r Model-Popularity}
models_sorted <- cars_edited %>% count(model_name) %>% arrange(desc(n)) # Most popular is Passat
View(models_sorted)
```


ggplot(cars_edited) + geom_point(aes(y = model_name, x = price_usd))

model_price <- lm(log(price_usd) ~ model_name + year_produced, data = cars_edited)

summary(model_price)


(Mikhail Mikhaylov) 8) Bar graph, Two-Way ANOVA/ : What is the average age of each vehicle manufacturer
and whether the manufacturer changes how the production year impacts the selling price?

```{r Manufacturer-Year-Average}
manufacturer_year <- group_by(cars_edited, manufacturer_name)
manufacturer_year_averages <- summarise(manufacturer_year, average = mean(year_produced, na.rm = TRUE))
View(manufacturer_year_averages)

ggplot(manufacturer_year_averages) + geom_point(aes(x = manufacturer_name, y = average))

ggplot(cars_edited) + geom_point(aes(x = year_produced, y = price_usd, color = manufacturer_name))
```

## Predictive Model
Finding out model popularity

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
